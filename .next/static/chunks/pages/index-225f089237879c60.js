(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return a(7290)}])},7290:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return em}});var r=a(5893),s=a(7294);let n=0,o=new Map,i=e=>{if(o.has(e))return;let t=setTimeout(()=>{o.delete(e),u({type:"REMOVE_TOAST",toastId:e})},1e6);o.set(e,t)},l=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:a}=t;return a?i(a):e.toasts.forEach(e=>{i(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===a||void 0===a?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},d=[],c={toasts:[]};function u(e){c=l(c,e),d.forEach(e=>{e(c)})}function m(e){let{...t}=e,a=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>u({type:"DISMISS_TOAST",toastId:a});return u({type:"ADD_TOAST",toast:{...t,id:a,open:!0,onOpenChange:e=>{e||r()}}}),{id:a,dismiss:r,update:e=>u({type:"UPDATE_TOAST",toast:{...e,id:a}})}}var p=a(3859),g=a(2003),f=a(8154),x=a(512),y=a(8388);function h(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,y.m6)((0,x.W)(t))}let v=p.zt,b=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(p.l_,{ref:t,className:h("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",a),...s})});b.displayName=p.l_.displayName;let N=(0,g.j)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),w=s.forwardRef((e,t)=>{let{className:a,variant:s,...n}=e;return(0,r.jsx)(p.fC,{ref:t,className:h(N({variant:s}),a),...n})});w.displayName=p.fC.displayName,s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(p.aU,{ref:t,className:h("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",a),...s})}).displayName=p.aU.displayName;let j=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(p.x8,{ref:t,className:h("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",a),"toast-close":"",...s,children:(0,r.jsx)(f.Z,{className:"h-4 w-4"})})});j.displayName=p.x8.displayName;let S=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(p.Dx,{ref:t,className:h("text-sm font-semibold",a),...s})});S.displayName=p.Dx.displayName;let T=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(p.dk,{ref:t,className:h("text-sm opacity-90",a),...s})});function C(){let{toasts:e}=function(){let[e,t]=s.useState(c);return s.useEffect(()=>(d.push(t),()=>{let e=d.indexOf(t);e>-1&&d.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>u({type:"DISMISS_TOAST",toastId:e})}}();return(0,r.jsxs)(v,{children:[e.map(function(e){let{id:t,title:a,description:s,action:n,...o}=e;return(0,r.jsxs)(w,{...o,children:[(0,r.jsxs)("div",{className:"grid gap-1",children:[a&&(0,r.jsx)(S,{children:a}),s&&(0,r.jsx)(T,{children:s})]}),n,(0,r.jsx)(j,{})]},t)}),(0,r.jsx)(b,{})]})}T.displayName=p.dk.displayName;var E=a(1571),D=a(4712);let I=e=>{let{...t}=e,{theme:a="system"}=(0,E.F)();return(0,r.jsx)(D.x7,{theme:a,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};var A=a(2654);let _=A.zt;A.fC,A.xz,s.forwardRef((e,t)=>{let{className:a,sideOffset:s=4,...n}=e;return(0,r.jsx)(A.VY,{ref:t,sideOffset:s,className:h("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",a),...n})}).displayName=A.VY.displayName;var R=a(9),k=a(202);let P={es:{multiplayer:{notConnected:"No conectado a Discord",yourTurn:"Tu turno",playerTurn:"Turno de {player}",participants:"Participantes",you:"T\xfa",waiting:"Esperando jugadores..."},app:{title:"\xa1Basta!",subtitle:"Di una palabra y toca su primera letra"},game:{category:"Categor\xeda",timeRemaining:"Tiempo restante",tapToStart:"Toca para empezar",start:"EMPEZAR",lettersUsed:"Letras usadas",newRound:"Nueva Ronda",settings:"Configuraci\xf3n",timer:"Temporizador",seconds:"segundos",players:"jugadores"},messages:{newRoundStarted:"\xa1Nueva ronda iniciada!",categoryIs:"Categor\xeda",letterSelected:'\xa1Letra "{letter}" seleccionada!',timerReset:"Temporizador reiniciado - turno del siguiente jugador",timeUp:"\xa1Se acab\xf3 el tiempo!",roundEnded:"Ronda terminada - nueva ronda en 3 segundos..."}},en:{multiplayer:{notConnected:"Not connected to Discord",yourTurn:"Your turn",playerTurn:"{player}'s turn",participants:"Participants",you:"You",waiting:"Waiting for players..."},app:{title:"Basta!",subtitle:"Say a word and tap its first letter"},game:{category:"Category",timeRemaining:"Time remaining",tapToStart:"Tap to start",start:"START",lettersUsed:"Letters used",newRound:"New Round",settings:"Settings",timer:"Timer",seconds:"seconds",players:"players"},messages:{newRoundStarted:"New Round Started!",categoryIs:"Category",letterSelected:'Letter "{letter}" selected!',timerReset:"Timer reset - next player's turn",timeUp:"Time's up!",roundEnded:"Round ended - starting new round in 3 seconds..."}}},L=(0,s.createContext)(void 0),U=e=>{let{children:t}=e,[a,n]=(0,s.useState)(()=>localStorage.getItem("basta-language")||"es");return(0,s.useEffect)(()=>{localStorage.setItem("basta-language",a)},[a]),(0,r.jsx)(L.Provider,{value:{language:a,setLanguage:n,t:e=>{let t=e.split("."),r=P[a];for(let e of t)r=null==r?void 0:r[e];return r||e}},children:t})},O=()=>{let e=(0,s.useContext)(L);if(!e)throw Error("useLanguage must be used within a LanguageProvider");return e};var G=a(6752),z=a(3454);let F=(0,s.createContext)(void 0),B=e=>{let{children:t}=e,[a,n]=(0,s.useState)(null),[o,i]=(0,s.useState)(null),[l,d]=(0,s.useState)([]),[c,u]=(0,s.useState)(!1),[m,p]=(0,s.useState)(!1),[g,f]=(0,s.useState)(null),[x,y]=(0,s.useState)(null),[h,v]=(0,s.useState)(!1),[b,N]=(0,s.useState)("initializing"),[w,j]=(0,s.useState)(null),[S,T]=(0,s.useState)(null),[C,E]=(0,s.useState)(null),[D,I]=(0,s.useState)(null),A=async(e,t)=>{try{console.log("Fetching connected participants...");let a=await e.commands.getInstanceConnectedParticipants();if(console.log("Instance participants:",a),a&&a.participants&&a.participants.length>0){let e=a.participants.map(e=>({id:e.id,username:e.username,discriminator:e.discriminator||"0000",avatar:e.avatar,global_name:e.global_name,bot:e.bot,flags:e.flags,premium_type:e.premium_type}));d(e),console.log("Participants updated:",e)}else d([t]),console.log("No other participants, setting current user only")}catch(e){console.log("Could not get participants:",e),d([t])}},_=e=>{try{console.log("Setting up SDK event listeners..."),e.subscribe("ACTIVITY_INSTANCE_PARTICIPANTS_UPDATE",e=>{if(console.log("Participants updated:",e),e.participants){let t=e.participants.map(e=>({id:e.id,username:e.username,discriminator:e.discriminator||"0000",avatar:e.avatar,global_name:e.global_name,bot:e.bot,flags:e.flags,premium_type:e.premium_type}));d(t)}}),e.subscribe("CURRENT_USER_UPDATE",e=>{console.log("Current user updated:",e);let t={id:e.id,username:e.username,discriminator:e.discriminator||"0000",avatar:e.avatar,global_name:e.global_name,bot:e.bot,flags:e.flags,premium_type:e.premium_type};i(t)})}catch(e){console.log("Could not set up event listeners:",e)}};return(0,s.useEffect)(()=>{(async()=>{try{console.log("=== DISCORD SDK INITIALIZATION START ==="),console.log("Window parent check:",window.parent!==window),console.log("Hostname check:",window.location.hostname),console.log("User agent check:",window.navigator.userAgent);let e=window.parent!==window||window.location.hostname.includes("discord.com")||window.navigator.userAgent.includes("Discord");if(console.log("Is in Discord?",e),!e){console.log("Running in standalone mode (not in Discord iframe)");let e={id:"dev-user-1",username:"DevUser",discriminator:"0000",global_name:"Development User",bot:!1};i(e),d([e,{id:"dev-user-2",username:"TestUser",discriminator:"0001",global_name:"Test User",bot:!1}]),u(!0),p(!0),v(!0),N("authenticated"),j("dev-channel-1"),T("dev-guild-1"),I("dev-instance-1"),E("en-US"),f(null);return}console.log("Running in Discord iframe, initializing SDK...");let t=z.env.NEXT_PUBLIC_DISCORD_CLIENT_ID||"1401020371154636841",a=new G.ho(t);console.log("Waiting for SDK ready..."),await a.ready(),console.log("SDK ready!"),a.instanceId=a.channelId||null,n(a),p(!0),N("ready"),_(a),a.channelId&&(j(a.channelId),I(a.channelId)),a.guildId&&T(a.guildId);try{let e=await a.commands.userSettingsGetLocale();E(e.locale)}catch(e){console.log("Could not get user locale:",e)}console.log("Starting authorization flow..."),N("authenticating");try{let e=await a.commands.authorize({client_id:t,response_type:"code",state:"",prompt:"none",scope:["identify","guilds","rpc.activities.write","rpc.voice.read"]});console.log("Authorization result:",e),N("authorized"),console.log("=== EXCHANGING CODE FOR ACCESS TOKEN ===");try{let t=await fetch("/api/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({code:e.code})});if(console.log("Token exchange response status:",t.status),t.ok){let{access_token:e}=await t.json();console.log("=== TOKEN EXCHANGE SUCCESS ==="),y(e);let r=await a.commands.authenticate({access_token:e});if(console.log("Discord authentication result:",r),r&&r.user){console.log("Using user data from auth result:",r.user);let e=r.user,t={id:e.id,username:e.username,discriminator:e.discriminator||"0000",avatar:e.avatar,global_name:e.global_name,bot:!1,flags:e.public_flags||0,premium_type:0};i(t),u(!0),v(!0),N("authenticated"),f(null),console.log("User set successfully from auth result:",t),await A(a,t);return}}else{console.error("=== TOKEN EXCHANGE FAILED ==="),console.error("Token exchange failed with status:",t.status);let e=await t.text();console.error("Error details:",e)}}catch(e){console.log("Token exchange failed:",e)}console.log("Setting fallback authenticated user...");let r={id:"auth-user",username:"AuthenticatedUser",discriminator:"0000",global_name:"Authenticated User",bot:!1};i(r),d([r]),u(!0),v(!0),N("authenticated"),f(null),console.log("Fallback user set:",r)}catch(e){console.error("Authorization failed:",e),N("error"),f(e instanceof Error?e.message:"Authentication failed")}}catch(t){console.error("Discord SDK initialization failed:",t),f(t instanceof Error?t.message:"Failed to connect to Discord"),N("error");let e={id:"fallback-user",username:"FallbackUser",discriminator:"0000",global_name:"Fallback User",bot:!1};i(e),d([e]),u(!0),p(!0),v(!0),N("authenticated"),j("fallback-channel"),T("fallback-guild"),I("fallback-instance"),E("en-US")}})()},[]),(0,r.jsx)(F.Provider,{value:{discordSdk:a,user:o,participants:l,isHost:c,isConnected:m,error:g,accessToken:x,authenticated:h,status:b,channelId:w,guildId:S,locale:C,instanceId:D},children:t})},M=()=>{let e=(0,s.useContext)(F);if(!e)throw Error("useDiscordSDK must be used within a DiscordProvider");return e},K=()=>{let{discordSdk:e,user:t,participants:a,isHost:r,isConnected:n,instanceId:o}=M(),[i,l]=(0,s.useState)({currentCategory:{id:"animals",es:"Animales",en:"Animals"},usedLetters:[],isGameActive:!1,currentPlayerIndex:0,playerScores:{},roundNumber:1,timerDuration:30,host:null});(0,s.useEffect)(()=>{if(a.length>0&&r){let e=a.reduce((e,t)=>(e[t.id]=0,e),{});l(t=>{var r;return{...t,playerScores:e,host:(null===(r=a[0])||void 0===r?void 0:r.id)||null}})}},[a,r]);let d=(0,s.useCallback)(async t=>{if(e&&r)try{console.log("Broadcasting event via Discord Activity:",t.type);let s=btoa(JSON.stringify({event:t,gameState:{currentCategory:i.currentCategory,usedLetters:i.usedLetters,isGameActive:i.isGameActive,currentPlayerIndex:i.currentPlayerIndex,roundNumber:i.roundNumber},timestamp:Date.now()})),n={details:"Playing Basta!",state:"".concat(i.currentCategory.en," | ").concat(s.slice(-100)),party:{id:"basta-game",size:[a.length,8]},instance:!0,timestamps:{start:Date.now()}};if(await e.commands.setActivity({activity:n}),o){i.currentCategory,i.usedLetters,i.isGameActive,i.currentPlayerIndex,i.roundNumber,Date.now(),console.log("Broadcasting to instance:",o,t.type);try{let e=await fetch("/sync",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({instanceId:o,event:t,gameState:{roundNumber:i.roundNumber,currentCategory:i.currentCategory,isGameActive:i.isGameActive,currentPlayerIndex:i.currentPlayerIndex,usedLetters:i.usedLetters,isHost:r,participants:a.map(e=>({id:e.id,username:e.username}))},timestamp:Date.now()})});e.ok?console.log("Successfully broadcasted via Discord URL mapping:",t.type):console.error("Failed to broadcast via Discord URL mapping:",e.status)}catch(e){console.error("Error broadcasting via Discord URL mapping:",e)}}}catch(e){console.error("Failed to broadcast event:",e)}},[e,r,i,a]),c=(0,s.useCallback)(e=>{switch(e.type){case"LETTER_SELECTED":l(t=>({...t,usedLetters:[...t.usedLetters,e.payload.letter],currentPlayerIndex:(t.currentPlayerIndex+1)%a.length}));break;case"ROUND_START":l(t=>({...t,currentCategory:e.payload.category,usedLetters:[],isGameActive:!0,currentPlayerIndex:0,roundNumber:t.roundNumber+1}));break;case"GAME_RESET":l(e=>({...e,usedLetters:[],isGameActive:!1,currentPlayerIndex:0,roundNumber:1,playerScores:a.reduce((e,t)=>(e[t.id]=0,e),{})}))}},[a.length]);(0,s.useEffect)(()=>{if(!t||!e)return;console.log("Setting up Discord URL mapping sync for instance:",o);let a=Date.now(),r=async()=>{try{let e=await fetch("/sync?instanceId=".concat(o,"&since=").concat(a),{method:"GET",headers:{"Content-Type":"application/json"}});if(e.ok){let r=await e.json();r.events&&r.events.length>0&&(console.log("Received ".concat(r.events.length," events via Discord URL mapping")),r.events.forEach(e=>{if(e.timestamp>a&&e.playerId!==t.id){console.log("Processing remote game event via URL mapping:",e.type,"from player:",e.playerId);let t={type:e.type,playerId:e.playerId,timestamp:e.timestamp,payload:e.payload||{}};c(t),a=e.timestamp}}))}else console.error("Failed to fetch events via Discord URL mapping:",e.status)}catch(e){console.error("Error polling via Discord URL mapping:",e)}},s=setInterval(r,2e3);return r(),()=>{s&&clearInterval(s)}},[t,e,o,c]);let u=(0,s.useCallback)(()=>{if(!r)return;let e=[{id:"animals",es:"Animales",en:"Animals"},{id:"food",es:"Comida",en:"Food"},{id:"countries",es:"Pa\xedses",en:"Countries"},{id:"professions",es:"Profesiones",en:"Professions"},{id:"colors",es:"Colores",en:"Colors"}],a=e[Math.floor(Math.random()*e.length)],s={type:"ROUND_START",payload:{category:a},timestamp:Date.now(),playerId:(null==t?void 0:t.id)||""};l(e=>({...e,currentCategory:a,usedLetters:[],isGameActive:!0,currentPlayerIndex:0,roundNumber:e.roundNumber+1})),d(s)},[r,null==t?void 0:t.id,d]),m=(0,s.useCallback)(()=>{if(!r)return;let e={type:"GAME_RESET",payload:{},timestamp:Date.now(),playerId:(null==t?void 0:t.id)||""},s=a.reduce((e,t)=>(e[t.id]=0,e),{});l(e=>({...e,usedLetters:[],isGameActive:!1,currentPlayerIndex:0,roundNumber:1,playerScores:s})),d(e)},[r,null==t?void 0:t.id,a,d]),p=(0,s.useCallback)(async r=>{if(!t||i.usedLetters.includes(r))return;let s=a[i.currentPlayerIndex];if((null==s?void 0:s.id)!==t.id)return;let n={type:"LETTER_SELECTED",payload:{letter:r},timestamp:Date.now(),playerId:t.id};l({...i,usedLetters:[...i.usedLetters,r],currentPlayerIndex:(i.currentPlayerIndex+1)%a.length});try{if(console.log("Broadcasting letter selection:",r),o){Date.now(),console.log("Broadcasting letter to instance:",o,r);let t={t:n.type.substring(0,10),p:n.playerId.slice(-6),ts:Date.now(),l:r},s=btoa(JSON.stringify(t));try{await e.commands.setActivity({activity:{details:"Round ".concat(i.roundNumber," - Letter Selected"),state:"Letter: ".concat(r,"|").concat(s).substring(0,128),party:{id:o,size:[a.length,8]},instance:!0}}),console.log("Successfully broadcasted letter selection via Discord activity:",r)}catch(e){console.error("Failed to update Discord activity for letter selection:",e)}}}catch(e){console.error("Failed to broadcast letter selection:",e)}},[t,i,a,e,o]),g=(0,s.useCallback)(()=>a[i.currentPlayerIndex],[a,i.currentPlayerIndex]),f=(0,s.useCallback)(()=>{let e=g();return(null==e?void 0:e.id)===(null==t?void 0:t.id)},[g,null==t?void 0:t.id]);return{gameState:i,startNewRound:u,resetGame:m,selectLetter:p,getCurrentPlayer:g,isCurrentPlayer:f,participants:a,isHost:r,isConnected:n,user:t}},Z=[{primary:"#5B2C87",secondary:"#00C5FF"},{primary:"#DD5228",secondary:"#FBAE52"},{primary:"#73d1d3",secondary:"#badcc3"},{primary:"#2a4dc1",secondary:"#5698e2"},{primary:"#fccd18",secondary:"#eb7195"},{primary:"#1abea5",secondary:"#96d165"}],V=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;(0,s.useEffect)(()=>{let a=Z.slice(0,t),r=a[e%a.length],s=document.documentElement;s.style.setProperty("--current-theme-primary",r.primary),s.style.setProperty("--current-theme-secondary",r.secondary),s.style.setProperty("--game-primary",r.primary),s.style.setProperty("--game-secondary",r.secondary),s.style.setProperty("--accent",r.secondary)},[e,t])};var Y=a(5482);let X=e=>{let{duration:t,isRunning:a,onTimeout:n,onStartGame:o,onStopGame:i,onReset:l}=e,[d,c]=(0,s.useState)(t),{t:u}=O();(0,s.useEffect)(()=>{c(t)},[t]),(0,s.useEffect)(()=>{l&&c(t)},[l,t]),(0,s.useEffect)(()=>{if(!a)return;let e=setInterval(()=>{c(e=>e<=1?(n(),0):e-1)},1e3);return()=>clearInterval(e)},[a,n]);let m=()=>{c(t)};(0,s.useEffect)(()=>{window&&(window.resetGameTimer=m)},[]);let p=d/t*100,g=d<=3;return(0,r.jsx)("div",{className:"flex flex-col items-center space-y-3",children:(0,r.jsxs)("div",{className:h("relative w-28 h-28 rounded-full flex items-center justify-center transition-all duration-300","bg-gradient-primary shadow-game cursor-pointer touch-manipulation",g&&a&&"animate-pulse-timer",!a&&"hover:scale-105 active:scale-95"),onClick:a?i:o,children:[a&&(0,r.jsx)("div",{className:"absolute inset-0 rounded-full border-4 border-accent transition-all duration-1000",style:{background:"conic-gradient(from 0deg, hsl(var(--game-secondary)) ".concat(3.6*p,"deg, transparent ").concat(3.6*p,"deg)")}}),a?(0,r.jsx)("span",{className:h("relative z-10 text-3xl font-bold text-foreground",g&&"text-game-danger"),children:d}):(0,r.jsxs)("div",{className:"relative z-10 flex flex-col items-center text-foreground",children:[(0,r.jsx)(Y.Z,{className:"w-8 h-8 mb-1"}),(0,r.jsx)("span",{className:"text-xs font-semibold",children:u("game.start")})]})]})})},H=e=>{let{usedLetters:t,onLetterSelect:a,disabled:s=!1}=e,n=e=>{s||t.has(e)||a(e)};return(0,r.jsx)("div",{className:"grid grid-cols-6 gap-2 max-w-sm mx-auto px-4",children:"ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").map(e=>{let a=t.has(e),o=s||a;return(0,r.jsxs)("button",{onClick:()=>n(e),disabled:o,className:h("relative w-14 h-14 rounded-xl font-bold text-base transition-all duration-200","flex items-center justify-center shadow-letter touch-manipulation","active:animate-letter-bounce select-none",!o&&["bg-gradient-accent text-foreground active:scale-95","shadow-lg transform-gpu active:shadow-xl"],a&&["bg-muted text-muted-foreground opacity-50 cursor-not-allowed","relative overflow-hidden"],s&&!a&&["bg-secondary text-secondary-foreground opacity-70 cursor-not-allowed"]),children:[(0,r.jsx)("span",{className:"relative z-10",children:e}),a&&(0,r.jsxs)("div",{className:"absolute inset-0 flex items-center justify-center",children:[(0,r.jsx)("div",{className:"w-8 h-0.5 bg-destructive rotate-45 absolute"}),(0,r.jsx)("div",{className:"w-8 h-0.5 bg-destructive -rotate-45 absolute"})]})]},e)})})},W=e=>{let{category:t,isActive:a}=e,{t:s,language:n}=O();return(0,r.jsxs)("div",{className:h("text-center p-4 mx-4 rounded-2xl transition-all duration-300","bg-gradient-secondary shadow-game",a?"scale-100 opacity-100":"scale-95 opacity-70"),children:[(0,r.jsx)("h2",{className:"text-xs uppercase tracking-wider text-muted-foreground mb-1",children:s("game.category")}),(0,r.jsx)("p",{className:"text-xl font-bold text-foreground capitalize leading-tight",children:t[n]})]})};var J=a(5595);let q=()=>{let{language:e,setLanguage:t}=O();return(0,r.jsxs)("button",{onClick:()=>{t("es"===e?"en":"es")},className:h("flex items-center gap-2 px-3 py-2 rounded-xl transition-all duration-200","bg-gradient-secondary text-foreground hover:scale-105 active:scale-95","shadow-letter touch-manipulation"),children:[(0,r.jsx)(J.Z,{className:"w-4 h-4"}),(0,r.jsx)("span",{className:"text-sm font-semibold uppercase",children:"es"===e?"ES":"EN"})]})};var Q=a(952);let $=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(Q.fC,{ref:t,className:h("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",a),...s})});$.displayName=Q.fC.displayName;let ee=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(Q.Ee,{ref:t,className:h("aspect-square h-full w-full",a),...s})});ee.displayName=Q.Ee.displayName;let et=s.forwardRef((e,t)=>{let{className:a,...s}=e;return(0,r.jsx)(Q.NY,{ref:t,className:h("flex h-full w-full items-center justify-center rounded-full bg-muted",a),...s})});et.displayName=Q.NY.displayName;let ea=(0,g.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function er(e){let{className:t,variant:a,...s}=e;return(0,r.jsx)("div",{className:h(ea({variant:a}),t),...s})}var es=a(7963),en=a(7377);let eo=()=>{let{participants:e,isHost:t,user:a,isConnected:s}=M(),{getCurrentPlayer:n,isCurrentPlayer:o}=K(),{t:i}=O(),l=n();return s?(0,r.jsxs)("div",{className:"space-y-3",children:[l&&(0,r.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-primary/10 rounded-lg",children:[(0,r.jsxs)($,{className:"h-6 w-6",children:[(0,r.jsx)(ee,{src:"https://cdn.discordapp.com/avatars/".concat(l.id,"/").concat(l.avatar,".png")}),(0,r.jsx)(et,{children:l.username[0]})]}),(0,r.jsx)("span",{className:"text-sm font-medium",children:o()?i("multiplayer.yourTurn"):"".concat(l.global_name||l.username,"'s turn")}),o()&&(0,r.jsx)(er,{variant:"secondary",className:"ml-auto",children:i("multiplayer.yourTurn")})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(es.Z,{className:"h-4 w-4"}),(0,r.jsxs)("span",{className:"text-sm font-medium",children:[i("multiplayer.participants")," (",e.length,")"]})]}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-2",children:e.map((e,s)=>(0,r.jsxs)("div",{className:"flex items-center gap-2 p-2 rounded-lg border ".concat(e.id===(null==l?void 0:l.id)?"bg-primary/10 border-primary/20":"bg-muted/50"),children:[(0,r.jsxs)($,{className:"h-6 w-6",children:[(0,r.jsx)(ee,{src:"https://cdn.discordapp.com/avatars/".concat(e.id,"/").concat(e.avatar,".png")}),(0,r.jsx)(et,{children:e.username[0]})]}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"text-xs font-medium truncate",children:e.global_name||e.username}),e.id===(null==a?void 0:a.id)&&(0,r.jsx)(er,{variant:"outline",className:"text-xs",children:i("multiplayer.you")})]}),t&&0===s&&(0,r.jsx)(en.Z,{className:"h-3 w-3 text-yellow-500"})]},e.id))})]})]}):(0,r.jsxs)("div",{className:"flex items-center gap-2 p-3 bg-destructive/10 rounded-lg",children:[(0,r.jsx)(es.Z,{className:"h-4 w-4 text-destructive"}),(0,r.jsx)("span",{className:"text-sm text-destructive",children:i("multiplayer.notConnected")})]})};var ei=a(1565),el=a(8426);let ed=(0,g.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),ec=s.forwardRef((e,t)=>{let{className:a,variant:s,size:n,asChild:o=!1,...i}=e,l=o?el.g7:"button";return(0,r.jsx)(l,{className:h(ed({variant:s,size:n,className:a})),ref:t,...i})});ec.displayName="Button";var eu=()=>{let{t:e}=O(),{gameState:t,startNewRound:a,resetGame:n,selectLetter:o,isCurrentPlayer:i,getCurrentPlayer:l,isHost:d,isConnected:c}=K(),[u,m]=(0,s.useState)(!1),[p,g]=(0,s.useState)(0);V(t.roundNumber,4);let f=(0,s.useCallback)(e=>{i()&&(o(e),g(e=>e+1))},[o,i]),x=(0,s.useCallback)(()=>{d&&n()},[n,d]),y=(0,s.useCallback)(()=>{d&&(a(),g(e=>e+1))},[a,d]),h=(0,s.useCallback)(()=>{d&&n()},[n,d]),v=(0,s.useCallback)(()=>{m(e=>!e)},[]);if(!c)return(0,r.jsx)("div",{className:"min-h-screen bg-gradient-game p-4 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center space-y-4",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-white mb-2",children:"Basta! Discord"}),(0,r.jsx)("p",{className:"text-white/80",children:"Connecting to Discord..."})]})});let b=l();return(0,r.jsx)("div",{className:"min-h-screen bg-gradient-game transition-all duration-1000",children:(0,r.jsxs)("div",{className:"container mx-auto px-4 py-6 max-w-4xl",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)("h1",{className:"text-3xl md:text-4xl font-bold text-white",children:"Basta!"}),d&&(0,r.jsx)(en.Z,{className:"h-6 w-6 text-yellow-400"})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(q,{}),(0,r.jsx)("button",{onClick:v,className:"p-2 text-white hover:text-white/80 transition-colors",children:(0,r.jsx)(ei.Z,{className:"h-5 w-5"})})]})]}),(0,r.jsx)("div",{className:"mb-6",children:(0,r.jsx)(eo,{})}),t.isGameActive&&b&&(0,r.jsx)("div",{className:"mb-4 text-center",children:(0,r.jsx)("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg ".concat(i()?"bg-green-500/20 text-green-100 border border-green-500/30":"bg-white/10 text-white/70"),children:i()?(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("span",{className:"font-medium",children:["\uD83C\uDFAF ",e("multiplayer.yourTurn")]})}):(0,r.jsxs)("span",{className:"font-medium",children:["⏳ Waiting for ",b.global_name||b.username]})})}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(X,{duration:t.timerDuration,isRunning:t.isGameActive,onTimeout:x,onStartGame:y,onStopGame:h},p)}),(0,r.jsx)(W,{category:t.currentCategory,isActive:t.isGameActive}),(0,r.jsx)(H,{usedLetters:new Set(t.usedLetters),onLetterSelect:f,disabled:!i()||!t.isGameActive}),t.usedLetters.length>0&&(0,r.jsxs)("div",{className:"text-center p-4 mx-4 rounded-2xl bg-white/10 backdrop-blur-md",children:[(0,r.jsx)("p",{className:"text-sm text-white/70 mb-1",children:e("game.usedLetters")}),(0,r.jsx)("p",{className:"text-lg font-medium text-white",children:t.usedLetters.join(", ").toUpperCase()})]}),d&&(0,r.jsxs)("div",{className:"flex justify-center gap-4",children:[(0,r.jsx)(ec,{onClick:y,disabled:t.isGameActive,className:"bg-green-600 hover:bg-green-700 text-white",children:e("game.newRound")}),(0,r.jsx)(ec,{onClick:h,disabled:!t.isGameActive,variant:"destructive",children:e("game.stop")})]})]}),u&&(0,r.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50",children:(0,r.jsxs)("div",{className:"bg-white rounded-2xl p-6 w-full max-w-md space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold",children:e("game.settings")}),(0,r.jsx)("button",{onClick:v,className:"text-gray-400 hover:text-gray-600",children:"✕"})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:e("game.gameMode")}),(0,r.jsx)("p",{className:"font-medium",children:"Discord Multiplayer"})]}),d&&(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"Host Controls"}),(0,r.jsx)("p",{className:"text-xs text-gray-500",children:"You can start/stop rounds and manage the game."})]})]})]})})]})})};function em(){let[e]=(0,s.useState)(()=>new R.S);return(0,r.jsx)(k.aH,{client:e,children:(0,r.jsx)(U,{children:(0,r.jsx)(B,{children:(0,r.jsxs)(_,{children:[(0,r.jsx)(C,{}),(0,r.jsx)(I,{}),(0,r.jsx)(eu,{})]})})})})}}},function(e){e.O(0,[583,888,774,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);